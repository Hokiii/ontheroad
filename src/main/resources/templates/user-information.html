<!DOCTYPE html>
<html lang="zh-CN" xmlns:th="http://www.thymeleaf.org">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="keywords" content="#">
    <meta name="description" content="#">
    <title>Homepage</title>
    <!-- Fav and touch icons -->
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="../static/images/favicon.ico">
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="../static/images/favicon.ico">
    <link rel="apple-touch-icon-precomposed" sizes="72x72" href="../static/images/favicon.ico">
    <link rel="apple-touch-icon-precomposed" href="../static/images/favicon.ico">
    <link rel="shortcut icon" href="../static/images/favicon.ico">
    <!-- Bootstrap -->
    <link href="../static/css/bootstrap.min.css" rel="stylesheet">
    <!-- Fontawesome -->
    <link href="../static/css/font-awesome.css" rel="stylesheet">
    <!-- Flaticons -->
    <link href="../static/css/font/flaticon.css" rel="stylesheet">
    <!-- Slick Slider -->
    <link href="../static/css/slick.css" rel="stylesheet">
    <!-- Range Slider -->
    <link href="../static/css/ion.rangeSlider.min.css" rel="stylesheet">
    <!-- Datepicker -->
    <link href="../static/css/datepicker.css" rel="stylesheet">
    <!-- magnific popup -->
    <link href="../static/css/magnific-popup.css" rel="stylesheet">
    <!-- Nice Select -->
    <link href="../static/css/nice-select.css" rel="stylesheet">
    <!-- Custom Stylesheet -->
    <link href="../static/css/style.css" rel="stylesheet">
    <!-- Custom Responsive -->
    <link href="../static/css/responsive.css" rel="stylesheet">
    <!-- Google Fonts -->
    <link href="../static/css/common.css" rel="stylesheet">
    <link href="../static/bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <link href="../static/fonts/iconfont.css" rel="stylesheet">

    <link href="https://fonts.googleapis.com/css?family=Poppins:300,400,500,600,700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700&display=swap" rel="stylesheet">
    <!-- CSS for IE -->
    <!--[if lte IE 9]>
    <link rel="stylesheet" type="text/css" href="css/ie.css"/>
    <![endif]-->
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
    <script type='text/javascript' src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <script type='text/javascript' src="http://cdnjs.cloudflare.com/ajax/libs/respond.js/1.4.2/respond.js"></script>
    <![endif]-->
    <!-- place -->
    <style>
        .form-group label,
        .form-group button {
            padding: 0 10px;
        }

        .information-item {
            margin-bottom: 10px;
            font-size: 16px;
        }

        .information {
            margin-bottom: 20px;
        }
    </style>
</head>
<body>
<!-- Start Header -->
<header class="header">
    <!-- Topbar -->
    <div class="topbar bg-custom-blue">
        <div class="container">
            <div class="row">
                <div class="col-sm-12">
                    <div class="right-side">
                        <ul class="custom-flex">
                            <li th:if="${session.user == null}">
                                <a href="/login" class="text-custom-white">登录</a>
                            </li>
                            <li th:if="${session.user == null}">
                                <a href="/register" class="text-custom-white">注册</a>
                            </li>
                            <li th:if="${session.user != null}">
                                欢迎您！
                                <span th:text="${session.user.getUsername()}"></span>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Topbar -->
    <!-- Navigation -->
    <div class="navigation">
        <div class="container">
            <div class="row">
                <div class="col-12">
                    <div class="main-navigation">
                        <div class="logo">
                            <a href="/index">
                                <img src="../static/images/logo.png" class="img-fluid image-fit" alt="img">
                            </a>
                        </div>
                        <div class="main-menu">
                            <div class="logo">
                                <a href="/index">
                                    <img src="../static/images/toor-logo.png" class="img-fluid image-fit" alt="img">
                                </a>
                            </div>
                            <nav>
                                <ul class="custom-flex">
                                    <li class="menu-item active">
                                        <a href="/index" class="text-light-dark">主页</a>
                                    </li>
                                    <li class="menu-item">
                                        <a href="/hotels" class="text-light-dark">酒店</a>
                                    </li>
                                    <li class="menu-item">
                                        <a href="/flights" class="text-light-dark">机票</a>
                                    </li>
                                    <li class="menu-item">
                                        <a href="/trains" class="text-light-dark">火车票</a>
                                    </li>
                                    <li class="menu-item">
                                        <a href="/cars" class="text-light-dark">租车</a>
                                    </li>
                                    <li class="menu-item">
                                        <a href="/productions" class="text-light-dark">旅游团购</a>
                                    </li>
                                    <li class="menu-item">
                                        <a href="/articles" class="text-light-dark">攻略</a>
                                    </li>
                                    <li class="menu-item menu-item-has-children">
                                        <a href="javascript;" class="text-light-dark">个人中心</a>
                                        <ul class="custom sub-menu">
                                            <li th:if="${session.user != null}" class="menu-item">
                                                <a href="/userInformation" class="text-custom-white">个人信息</a>
                                            </li>
                                            <li th:if="${session.user != null}"
                                                class="menu-item menu-item-has-children">
                                                <a href="#" class="text-custom-white">我的订单</a>
                                                <ul class="custom sub-menu">
                                                    <li class="menu-item">
                                                        <a href="/flightsOrders" class="text-custom-white">火车票</a>
                                                    </li>
                                                    <li class="menu-item">
                                                        <a href="/carsOrders" class="text-custom-white">机票</a>
                                                    </li>
                                                    <li class="menu-item">
                                                        <a href="/hotelsOrders" class="text-custom-white">酒店</a>
                                                    </li>
                                                    <li class="menu-item">
                                                        <a href="/carsOrders" class="text-custom-white">车辆</a>
                                                    </li>
                                                    <li class="menu-item">
                                                        <a href="/productionsOrders" class="text-custom-white">旅游团购</a>
                                                    </li>
                                                </ul>
                                            </li>
                                            <li th:if="${session.user != null}" class="menu-item">
                                                <a href="/myArticles" class="text-custom-white">我的攻略</a>
                                            </li>
                                            <li th:if="${session.user != null && session.user.getRole() == 2}"
                                                class="menu-item">
                                                <a href="/productionsManage" class="text-custom-white">商品管理</a>
                                            </li>
                                            <li class="menu-item">
                                                <a href="/questions" class="text-custom-white">常见问题</a>
                                            </li>
                                            <li class="menu-item">
                                                <a href="/contactUs" class="text-custom-white">联系我们</a>
                                            </li>
                                            <li class="menu-item" th:if="${session.user != null}">
                                                <a href="/exit" class="text-custom-white">退出</a>
                                            </li>
                                        </ul>
                                    </li>
                                </ul>
                            </nav>
                        </div>
                        <div class="hamburger-menu">
                            <div class="menu-btn">
                                <span></span>
                                <span></span>
                                <span></span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Navigation -->
</header>
<!-- End Header -->
<div class="change-message" th:if="${message!=null}">
    <div class="container">
        <div class="row">
            <div class="container">
                <div class="alert alert-success alert-dismissible" role="alert">
                    <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span
                            aria-hidden="true">&times;</span></button>
                    <strong th:text="${message}"></strong>
                </div>
            </div>
        </div>
    </div>
</div>


<div class="information">
    <div class="container">
        <div class="listing-meta-sec mb-md-80">
            <hr>
            <div class="tabs">
                <ul class="custom-flex nav nav-tabs mb-xl-20">
                    <li class="nav-item">
                        <a class="nav-link active" data-toggle="tab" href="#overview">个人信息</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" data-toggle="tab" href="#amenities">修改密码</a>
                    </li>
                </ul>
                <div class="tab-content">
                    <div class="tab-pane fade active show" id="overview">
                        <div class="container">
                            <div class="basic-information">
                                <h3 class="text-info">基本信息</h3>
                                <hr>
                                <div class="row">
                                    <div class="col-md-3 col-sm-6 col-xs-12 information-item">
                                        <label>昵称：</label>
                                        <span th:if="${session.user!=null}"
                                              th:text="${session.user.getUsername()}"></span>
                                    </div>
                                    <div class="col-md-3 col-sm-6 col-xs-12 information-item">
                                        <label>性别：</label>
                                        <span th:if="${session.user!=null}" th:text="${session.user.getSex()}"></span>
                                    </div>
                                    <div class="col-md-3 col-sm-6 col-xs-12 information-item">
                                        <label>生日：</label>
                                        <span th:if="${session.user!=null}"
                                              th:text="${session.user.getBirthday()}"></span>
                                    </div>
                                    <div class="col-md-3 col-sm-6 col-xs-12 information-item">
                                        <label>手机号：</label>
                                        <span th:if="${session.user!=null}" th:text="${session.user.getPhone()}"></span>
                                    </div>
                                    <div th:if="${session.user.getName()!=null}"
                                         class="col-md-3 col-sm-6 col-xs-12 information-item">
                                        <label>姓名：</label>
                                        <span th:text="${session.user.getName()}"></span>
                                    </div>
                                    <div th:if="${session.user.getIdentityNumber()!=null}"
                                         class="col-md-6 col-sm-6 col-xs-12 information-item">
                                        <label>身份证号：</label>
                                        <span th:text="${session.user.getIdentityNumber()}"></span>
                                    </div>
                                    <div th:if="${session.user.getJob()!=null}"
                                         class="col-md-3 col-sm-6 col-xs-12 information-item">
                                        <label>职业类型：</label>
                                        <span th:text="${session.user.getJob()}"></span>
                                    </div>
                                </div>
                            </div>
                            <div th:if="${session.user.getName()==null}" class="complete-information">
                                <h3 class="text-info">完善个人信息</h3>
                                <hr>
                                <div>
                                    <span class="text-danger">真实信息只允许修改一次</span>
                                </div>

                                <form action="/completeInformation" method="post">
                                    <div class="form-group">
                                        <label for="name">姓名</label>
                                        <input type="text" name="name" class="form-control" id="name" placeholder="姓名"
                                               required>
                                    </div>
                                    <div class="form-group">
                                        <label for="identityNumber">身份证号</label>
                                        <input type="text" name="identityNumber" class="form-control"
                                               id="identityNumber" placeholder="身份证号" required>
                                        <div id="identityNumberError" class="message-pane bg-danger hide">请输入正确身份证号！</div>
                                    </div>
                                    <div class="form-group">
                                        <label for="job">职业类别</label>
                                        <select id="job" name="job" class="form-control" required>
                                            <option value="技术" selected>技术</option>
                                            <option value="产品">产品</option>
                                            <option value="设计">设计</option>
                                            <option value="运营">运营</option>
                                            <option value="市场">市场</option>
                                            <option value="人事">人事</option>
                                            <option value="高级管理">高级管理</option>
                                            <option value="销售">销售</option>
                                            <option value="媒体">媒体</option>
                                            <option value="金融">金融</option>
                                            <option value="教育培训">教育培训</option>
                                            <option value="医疗健康">医疗健康</option>
                                            <option value="采购/贸易">采购/贸易</option>
                                            <option value="供应链/物流">供应链/物流</option>
                                            <option value="房地产/建筑">房地产/建筑</option>
                                            <option value="咨询/翻译/法律">咨询/翻译/法律</option>
                                            <option value="旅游">旅游</option>
                                            <option value="服务业">服务业</option>
                                            <option value="生产制造">生产制造</option>
                                            <option value="其他">其他</option>
                                        </select>
                                    </div>
                                    <button type="submit" class="btn btn-info pull-right">确认修改</button>
                                </form>
                            </div>
                        </div>
                    </div>
                    <div class="tab-pane fade" id="amenities">
                        <form action="/changePassword" method="post">
                            <div class="form-group">
                                <label for="primaryPassword">原始密码</label>
                                <input type="password" class="form-control" id="primaryPassword" placeholder="请输入原始密码" required>
                                <div id="primaryPasswordError" class="message-pane bg-danger hide">原密码错误</div>
                            </div>
                            <div class="form-group">
                                <label for="newPassword">新密码</label>
                                <input type="password" class="form-control" name="newPassword" id="newPassword"
                                       placeholder="请输入新密码" required>
                                <div id="newPasswordError" class="message-pane bg-danger hide">请输入4-16位密码！</div>
                            </div>
                            <div class="form-group">
                                <label for="confirmPassword">确认新密码</label>
                                <input type="password" class="form-control" id="confirmPassword" placeholder="确认新密码" required>
                                <div id="confirmPasswordError" class="message-pane bg-danger hide">两次密码输入不一致！</div>
                            </div>
                            <button type="submit" class="btn btn-info pull-right">确认修改</button>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Start Copyright -->
<div class="copyright">
    <div class="container">
        <div class="row">
            <div class="col-12">
                <p class="text-custom-white">Copyright &copy; 2020.On the Road All rights reserved.</p>
            </div>
        </div>
    </div>
</div>
<!-- End Copyright -->
<div id="back-top" class="back-top">
    <a href="#top"><i class="flaticon-arrows"></i></a>
</div>
<!-- Place all Scripts Here -->
<!-- jQuery -->
<script src="../static/js/jquery.min.js"></script>
<!-- Popper -->
<script src="../static/js/popper.min.js"></script>
<!-- Bootstrap -->
<script src="../static/js/bootstrap.min.js"></script>
<!-- Range Slider -->
<script src="../static/js/ion.rangeSlider.min.js"></script>
<!-- Slick Slider -->
<script src="../static/js/slick.min.js"></script>
<!-- Datepicker -->
<script src="../static/js/datepicker.js"></script>
<script src="../static/js/datepicker.en.js"></script>
<!-- Isotope Gallery -->
<script src="../static/js/isotope.pkgd.min.js"></script>
<!-- Nice Select -->
<script src="../static/js/jquery.nice-select.js"></script>
<!-- magnific popup -->
<script src="../static/js/jquery.magnific-popup.min.js"></script>
<!-- Maps -->
<script src="https://ditu.google.cn/maps/api/js?key=AIzaSyDnd9JwZvXty-1gHZihMoFhJtCXmHfeRQg"></script>
<!-- Custom Js -->
<script src="../static/js/custom.js"></script>

<script>
    function validatorIdentityNumber(content){
        eval("var reg = /(^\\d{15}$)|(^\\d{18}$)|(^\\d{17}(\\d|X|x)$)/;");
        return RegExp(reg).test(content);
    }
    $(function () {
        $("#primaryPassword").blur(function () {
            $.ajax({
                type: "post",
                url: "/checkPrimaryPassword",
                data: {
                    primaryPassword: $("#primaryPassword").val()
                },
                dataType: "text",
                success: function (data) {
                    if (data === "false") {
                        $("#primaryPasswordError").removeClass("hide");
                    } else {
                        if (!$("#primaryPasswordError").hasClass("hide")) {
                            $("#primaryPasswordError").addClass("hide");
                        }
                    }
                }
            });
        });
        $("#newPassword").blur(function () {
            if ($("#newPassword").val().length < 4 || $("#newPassword").val().length > 16) {
                $("#newPasswordError").removeClass("hide");
            } else {
                if (!$("#newPasswordError").hasClass("hide")) {
                    $("#newPasswordError").addClass("hide");
                }
            }
        });
        $("#confirmPassword").blur(function () {
            if ($("#newPassword").val() !== $("#confirmPassword").val()) {
                $("#confirmPasswordError").removeClass("hide");
            } else {
                if (!$("#confirmPasswordError").hasClass("hide")) {
                    $("#confirmPasswordError").addClass("hide");
                }
            }
        });
        $("#identityNumber").blur(function () {
            if(!validatorIdentityNumber($("#identityNumber").val())) {
                $("#identityNumberError").removeClass("hide");
            }else {
                if(!$("#identityNumberError").hasClass("hide")) {
                    $("#identityNumberError").addClass("hide");
                }
            }
        });
    });
</script>
<!-- /Place all Scripts Here -->
</body>
</html>